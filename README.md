## 问题

有一个巨大的txt文件，里面有不到一亿行数据，每行是一个8位座机号码，可以保证没有重复。

需要重新从小到大排序， 可使用的内存非常有限（不到100兆，在一台ARM 嵌入式设备上运行）

归并排序花了一个多小时，客户只能接受1分钟以内。

## 思路

在内存非常有限的情况下，对于巨大的文本文件进行排序是具有挑战性的。基于归并排序的传统方法需要在内存中加载和操作大量数据，因此可能无法在给定的时间限制内完成任务。

一个可行的方案是使用外部排序（External Sort），这是一种适用于大型数据集的排序方法，可以有效地处理无法一次性加载到内存中的数据。

下面是使用外部排序的一种简化实现方法：

1. 将原始文本文件按照内存能够容纳的大小划分为多个临时文件。例如，将文本文件分成若干个大小约为1兆的小文件。
2. 对每个小文件进行内部排序，可以使用常见的排序算法（如快速排序、堆排序等），以确保每个小文件内部的数据是有序的。
3. 针对每个小文件，维护一个指针或缓冲区，从每个小文件中读取（缓存）一小部分数据到内存中。
4. 使用多路归并（k-way merge）的方式，从每个小文件的缓冲区中选择最小的元素，合并成一个大的有序序列。
5. 将合并后的序列写入一个输出文件。
6. 重复步骤3到步骤5，直到所有的小文件都被处理并合并成一个有序的输出文件。

通过这种方式，每次只需要将能够放入内存的数据操作，因此可以在有限的内存下进行排序。请注意，由于数据量很大，对应的I/O操作可能会成为整个流程的主要时间瓶颈。

最后，对于此具体需求来说，如果在ARM嵌入式设备上运行一台设备需要在1分钟以内完成排序，并且内存限制非常严格，可能需要对数据处理的算法进行进一步调优，或者考虑使用更高性能的设备或分布式系统来处理数据。

## K-way Merge
多路归并（k-way merge）是一种合并多个有序序列的算法。在计算机科学中，归并排序（Merge Sort）是一种经典的排序算法，它通常使用多路归并来实现。

在多路归并算法中，有k个有序序列需要合并，其中k可以是任意正整数。算法的目标是将这k个有序序列合并成一个有序序列。

多路归并算法的基本思想是通过比较每个序列中的元素，选择最小的元素放入结果序列中，然后将该元素所在的序列的指针向后移动一位。重复这个过程，直到所有的元素都被合并到结果序列中。

具体步骤如下：

1. 创建一个大小为k的最小堆（Min Heap），并将每个序列的第一个元素放入堆中。
2. 从堆中取出堆顶元素，即最小的元素，放入结果序列中。
3. 将该元素所在的序列的指针向后移动一位，如果该序列还有元素，将新的元素放入堆中。
4. 重复步骤2和步骤3，直到堆为空。
5. 最后得到的结果序列就是合并后的有序序列。

多路归并算法的时间复杂度为O(nlogk)，其中n是所有序列中元素的总数。这是因为每次从堆中取出最小元素的操作的时间复杂度为O(logk)，总共需要进行n次这样的操作。

多路归并算法在很多应用中都有广泛的应用，比如外部排序、数据库查询等。它可以高效地合并多个有序序列，减少了排序的时间复杂度，提高了算法的效率。

总结来说，多路归并是一种合并多个有序序列的算法。它通过比较每个序列中的元素，选择最小的元素放入结果序列中，重复这个过程直到所有的元素都被合并到结果序列中。多路归并算法的时间复杂度为O(nlogk)，在很多应用中有广泛的应用。
